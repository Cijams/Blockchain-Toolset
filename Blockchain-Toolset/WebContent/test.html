<!DOCTYPE html>
<html lang="en">
<button id="somebutton" class="btn btn-outline-success my-1 my-sm-0" type="button">Search</button>

<script>

async function f() {

	  let promise = new Promise((resolve, reject) => {
	    setTimeout(() => resolve("done!"), 8000)
	  });

	  let result = await promise; // wait till the promise resolves (*)

	  alert(result); // "done!"
	}

	f();
	
	
	
	
	
	<script type="text/javascript">
    let blockData = [];
    var height = 0;
    
    $(document).on("click", "#somebutton", function myFunc() {
    	let promise = new Promise(function(resolve, reject) {
    	
    	height = 5;//document.getElementById("blockSearch").elements[0].value;
     	$.post("TestServlet", {
        	blockNumber: height + ""
        }, function(responseJson) {
          $.each(responseJson, function(index, item) {
            blockData.push(item);
          });
        });
        console.log(blockData);

     		// first response is awlays an empty array, even when hard coded response.
     		// try ajax instead of current jquery....
     		// promises finish, undefined is response in time... interesting.,
     	
     	if (typeof blockData[0] !== 'undefined') {
     	    resolve(blockData[0]);
     	  }
     	else {
     		reject(height);
     	}
    });
	  	// resolve runs the first function in .then
	  	promise.then(
	  	  result => myFunction(),
	  	  error => myFunc()
	  	);
	    function myFunction() {
	    	var counter = 0;
	        var field = blockData[counter++];
	        var data = blockData[counter++];
	        var markup = "<tr><td>" + field + "</td><td>" + data;
	        $("table tbody").append(markup);
	    }
	});

    
  </script>


</script>